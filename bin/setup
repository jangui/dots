#!/bin/bash

#git setup
git config --global user.name "jangui"
git config --global user.email "jaimitino@gmail.com"

#check distro, update & a few downloads
distro="$(cat /etc/os-release | grep -w ID | tr -d ID= )"
if [ $distro == "arch" ]; then
    sudo pacman -Syu && sudo pacman -S zsh vim curl lolcat python3-pip
    rm -rf $HOME/.config/termite $HOME/.config/polybar /etc/pacman.conf
    ln -s $HOME/.dots/config/pacman/pacman.conf /etc/pacman.conf
    ln -s $HOME/.dots/config/termite $HOME/.config/termite
    ln -s $HOME/.dots/config/polybar $HOME/.config/polybar
    ln -s $HOME/.dots/config/i3 $HOME/.config/i3
elif [ $distro == "ubuntu" ] || [ $distro == "raspbian" ]; then
    sudo apt update && sudo apt upgrade && sudo apt install zsh vim curl lolcat python3-pip 
else
    echo "unknown distro: $distro" 
    exit 1
fi

#set default shell
chsh $(whoami) -s $(which zsh)

#install oh-my-zsh
sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)" "" --unattended

#zsh syntax highlighting
cd $HOME/.oh-my-zsh/custom/plugins
git clone git://github.com/zsh-users/zsh-syntax-highlighting.git
cd ~

#setup configs
rm -rf $HOME/.vimrc 
ln -s $HOME/.dots/config/vim/vimrc $HOME/.vimrc
rm -rf $HOME/.zshrc 
ln -s $HOME/.dots/config/zsh/zshrc $HOME/.zshrc
rm -rf $HOME/.profile 
ln -s $HOME/.dots/config/profile $HOME/.profile
rm -rf $HOME/.oh-my-zsh/themes/jangui.zsh-theme
ln -s $HOME/.dots/config/zsh/jangui.zsh-theme $HOME/.oh-my-zsh/themes/jangui.zsh-theme
rm -rf $HOME/.oh-my-zsh/themes/jangui2.zsh-theme
ln -s $HOME/.dots/config/zsh/jangui2.zsh-theme $HOME/.oh-my-zsh/themes/jangui.zsh-theme
rm -rf $HOME/.banner 
ln -s $HOME/.dots/config/zsh/banner $HOME/.banner
touch $HOME/.dots/config/zsh/custom_rc
touch $HOME/.dots/config/zsh/custom_env_vars
touch $HOME/.dots/config/zsh/custom_aliases
chmod +x $HOME/.banner

#make trash folder
mkdir -p $HOME/.trash

#make root trask folder
sudo mkdir -p /root/.trash

#set up cron for emptying trash
chmod +x $HOME/.dots/bin/empty_trash
sudo ln -s $HOME/.dots/bin/empty_trash /etc/cron.weekly

source $HOME/.zshrc
