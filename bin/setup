#!/bin/bash

# git setup
git config --global user.name "jangui"
git config --global user.email "jaimitino@gmail.com"

# check distro, update & a few downloads
distro="$(cat /etc/os-release | grep -w ID | tr -d ID= )"
if [ $distro == "arch" ]; then
    sudo pacman -Syu && sudo pacman -S zsh vim compton i3 i3status i3lock-color dmenu feh termite xorg-server xorg-xinit lolcat
    sudo rm -rf $HOME/.config/termite /etc/pacman.conf
    sudo ln -s $HOME/.dots/config/pacman/pacman.conf /etc/pacman.conf
    sudo ln -s $HOME/.dots/config/termite $HOME/.config/termite
    sudo ln -s $HOME/.dots/config/i3 $HOME/.config/i3
elif [ $distro == "ubuntu" ] || [ $distro == "raspbian" ]; then
    sudo apt update && sudo apt upgrade && sudo apt install zsh vim lolcat
else
    echo "unknown distro: $distro" 
    exit 1
fi

# set default shell
sudo chsh $(whoami) -s $(which zsh)

# install oh-my-zsh
sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)" "" --unattended

# zsh syntax highlighting
git clone https://github.com/zsh-users/zsh-syntax-highlighting.git $HOME/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting
chmod g-w,o-w $HOME/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting

# setup configs
rm -rf $HOME/.vimrc 
ln -s $HOME/.dots/config/vim/vimrc $HOME/.vimrc
rm -rf $HOME/.zshrc 
ln -s $HOME/.dots/config/zsh/zshrc $HOME/.zshrc
rm -rf $HOME/.profile 
ln -s $HOME/.dots/config/profile $HOME/.profile
rm -rf $HOME/.oh-my-zsh/themes/jangui.zsh-theme
ln -s $HOME/.dots/config/zsh/jangui.zsh-theme $HOME/.oh-my-zsh/themes/jangui.zsh-theme
rm -rf $HOME/.oh-my-zsh/themes/jangui-ssh.zsh-theme
ln -s $HOME/.dots/config/zsh/jangui-ssh.zsh-theme $HOME/.oh-my-zsh/themes/jangui-ssh.zsh-theme
rm -rf $HOME/.banner 
cp $HOME/.dots/config/zsh/banner $HOME/.banner
chmod +x $HOME/.banner
rm -rf $HOME/.xinitrc
ln -s $HOME/.dots/config/xorg/xinitrc $HOME/.xinitrc
ln -s $HOME/.dots/config/xorg/Xresources $HOME/.Xresources
touch $HOME/.dots/config/zsh/custom_rc
touch $HOME/.dots/config/zsh/custom_env_vars
touch $HOME/.dots/config/zsh/custom_aliases

# make trash folder
mkdir -p $HOME/.trash

# make root trash folder
sudo mkdir -p /root/.trash

source $HOME/.zshrc
echo "REMINDER: add emptying trash cronjob"
